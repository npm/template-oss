name: CI {{~#if isWorkspace}} - {{pkgName}}{{/if}}

on:
  {{> setupCiOn}}

jobs:
  lint:
    name: Lint
    {{> setupJob }}
      - name: npm run lint {{~#if isWorkspace}} -w {{pkgName}}{{/if}}
        run: {{rootNpmPath}} run lint --ignore-scripts {{~#if isWorkspace}} -w {{pkgName}}{{/if}}
      - name: npm run postlint {{~#if isWorkspace}} -w {{pkgName}}{{/if}}
        run: {{rootNpmPath}} run postlint --ignore-scripts {{~#if isWorkspace}} -w {{pkgName}}{{/if}}

  test:
    name: Test
    {{> setupJobMatrix }}
      - name: Add tap Problem Matcher
        run: echo "::add-matcher::.github/matchers/tap.json"
      - name: npm test {{~#if isWorkspace}} -w {{pkgName}}{{/if}}
        run: {{rootNpmPath}} test --ignore-scripts {{~#if isWorkspace}} -w {{pkgName}}{{/if}}
